---
article: true
author: Neonscape
date: 2023-06-15
image: /assets/imgs/bgs/12.png
cover: /assets/imgs/bgs/25.png
category: 
- notes
tags:
- discrete mathematics
- bipartite graph
- perfect match
- Hall's theorem
---

# 离散数学复习：二部图与匹配

~~寄寄寄寄摆摆摆摆~~

<!-- more -->

## 二部图
---
### 二部图：定义
可以将顶点集划分为两个不相交的类别、每一条边的两个端点都在不同类别中的图。
### 完全二部图
来自不同类别的任意两个顶点之间均有边相连。

---

## 图中的匹配

---

- 匹配：一张图中互不相邻的边的集合，记为`M`。
- M-饱和点：`M`中各点的端点。

### 二部图中的完备匹配

**定义**：设`G`为二部图且可被二部划分为`<V1, V2>`, 若`G`中的匹配`M`能够饱和`V1`中所有的顶点，则称`M`是 **`V1`到`V2`的** 完备匹配`（**不是完美匹配！**）

*注：完备匹配一定是最大匹配，但当且仅当`|V1| = |V2|`时该匹配才能被称为完美匹配。*

### Hall定理

设二部图`G = <V1, V2, E>`， 则`G`有从V1到V2的完备匹配当且仅当对于任意`v∈V1`, 有`|N(v)|(v的相邻顶点数) ≥ |V1|`.

证明：

必要性显然。

充分性：

1. 当`|V1| == 1`时充分性显然成立。
2. 假设当`|V1| ≤ k (k ≥ 1)`时充分性成立，现证明当`|V1| == k + 1`时命题也成立。<br>分成两种情况证明。

>(1). 对于`V1`的任意真子集`A`，`|N(A)| > |A|`:
>
>从`V1`中任取一个顶点`v`, 从`M(v)`中任取一个顶点`w`；
>
>则有`v ∈ V1, w ∈ V2`.
>
>由归纳假设得，此时`V1 - {v} 到 V2 - {w}`构成一个完备匹配。
>
>可得上述完备匹配加上边`(v, w)`可以构成从`V1`到`V2`的完备匹配。
>
><br>
>(2). 存在`V1`的一个**真**子集`A'`，`|N(A')| = |A'|`.
>
>记`B' = N(A')`。
>
>根据归纳假设，存在从`A'`到`B'`的完备匹配。又因为假设，有`|V2 - B'| ≥ |V1 - A'|`。
>
>即存在从`V1 - A'`到`V2 - B'`的一个完备匹配。
>
>将以上两个匹配相合并，即可得到一个`V1`到`V2`的完备匹配。

### Hall定理：推论

#### 正则图
*正则图（regular graph）是指每个顶点都有相同数目的相邻顶点的图(亦即`对于任意v∈G, N(v) ≡ k`)， 称为`k-正则图`.*

*特别的，阶（图中的点数）为`K`的`K-1 - 正则图`即为`K-完全图`*。

#### 推论内容
**设*二部图*`G`是`K-正则`的`(k ≥ 1)`， 则`G`有*完美*匹配。**

#### 证明
>设`G = <A, B, E>`, 则有`K|A| = K|B|`（每个点所连接的边数相同，但所有边均存在于两组点之间），因此`|A|=|B|`.
>
>对于任意一**集合**`S ∈ A`, `S`与`N(S)`之间共有`K|S|`条边；但与`N(S)`相关的边共有`K|N(S)|`条。
>
>因此有`K|N(S)| ≥ K|S|`（从`S`连接到`N(S)`的边包含在与`N(S)`有关的边之中）。
><br>因此， `|N(S)| ≥ |S|`.
>
>由霍尔定理得，在`G`中存在从`A`到`B`的完备匹配。又因为`|A| = |B|`，所以该匹配是完美匹配。

#### 另一个推论（更一般的情况）
二部图`G = <V1, V2, E>`, 若`V1`中每个顶点至少关联`t`条边，而若`V2`中每个顶点至多关联`t`条边，则`G`中存在`V1`到`V2`的完备匹配。

---

### 交错路径与可增广路径
设`M`是`G`中的一个匹配。若`G`的一条路径`P`中，属于`M`的边和不属于`M`的边**交替**出现，则称`P`为`M-交错路径`；

若`P`的起点和终点都是`M-非饱和点`，则称`P`是`可增广交错路径`。

### Berge定理
`M`是`G`的最大匹配，当且仅当`G`中不存在`M-可增广交错路径`。

证明参见：
[Proof of Berge's Theorem](https://www.mscs.dal.ca/~janssen/4115/presentations/Poppy.pdf)

### 稳定匹配问题

#### 偏好集
`G`上的一个偏好集是一族线性序`(≤v), v∈V`；其中, `≤v`是`E(v)`上的线性序（对`v`相连的边进行排序）。

#### 稳定匹配
`G`上的匹配`M`是稳定的，当且仅当对于`M`中任意一条边`e`, 存在边`f ∈ E - M`， 满足：

- `e`和`f`有公共端点
- `e ≤v f`.
